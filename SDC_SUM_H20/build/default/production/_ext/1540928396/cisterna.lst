MPASM 5.86                      CISTERNA.ASM   8-6-2020  22:19:26         PAGE  1


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

Warning[205]: Found directive in column 1. (LIST)
                      00001 LIST P=16f877a;     INDICANDO PROCESADOR
                      00002 ;INCLUYENDO LAS LIBRERIA QUE VAMOS A UTILIZAR
                      00003     #include "p16f877a.inc"    
                      00001         LIST
                      00002 
                      00003 ;==========================================================================
                      00004 ; Build date : Oct 24 2019
                      00005 ;  MPASM PIC16F877A processor include
                      00006 ; 
                      00007 ;  (c) Copyright 1999-2019 Microchip Technology, All rights reserved
                      00008 ;==========================================================================
                      00009 
                      00567         LIST
                      00004 
                      00005 ; CONFIG. DEL CLOCK A 20MHZ, WATCHDOG DESHABILITADO Y POWER-UP TIMER ON
2007   3F72           00006     __CONFIG _FOSC_HS & _WDTE_OFF & _PWRTE_ON & _BOREN_ON & _LVP_OFF & _CPD_OFF & _WRT_OFF & _CP_OFF
                      00007 
                      00008 ;* DEFINICION DE VARIABLES Y SU ALMACENAMIENTO
                      00009 ;*
                      00010     CBLOCK 0xA0
  000000A0            00011         SMS;            VARIABLE 0
  000000A1            00012         SMS_ERR_STATUS  ; VARIABLE 1
  000000A2            00013         SMS_FERR        ; VARIABLE 2
  000000A3            00014         SMS_OERR        ; VARIABLE 3
  000000A4            00015         NIVEL_TINACO    ;
                      00016     ENDC
                      00017 
                      00018     ORG 0X00
0000   1303           00019     BCF STATUS,RP1;                             CAMBIO DE BANCO
0001   1283           00020     BCF STATUS,RP0;BANCO 0
0002   2???           00021     GOTO        INICIO
Warning[205]: Found directive in column 1. (ORG)
                      00022 ORG 0X04
0004   1303           00023     BCF STATUS,RP1;                             CAMBIO DE BANCO
0005   1283           00024     BCF STATUS,RP0;BANCO 0
0006   1A8C           00025     BTFSC PIR1, RCIF;      SI HAY MENSAJE VERIFICO QUE PASO PRIMERO
0007   2???           00026     CALL RECIBIR;           SI NO HAY MENSAJE PREGUNTO SI ESTA ACTIVADO MODO MANUAL 
0008   0009           00027     RETFIE
                      00028     
0009                  00029 RECIBIR:
0009   0180           00030     CLRF W; LIMPIO PARA SABER EL TIPO DE ERROR AL SALIR DEL CICLO, SI W SALE CON 0 DE AQUI, TODO OK
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
000A   01A1           00031     CLRF SMS_ERR_STATUS;    LIMPIO EL ERROR QUE HUBO POR SI OCURRE OTRO, LLEVO CONTROL
000B   1E8C           00032     BTFSS PIR1, RCIF;       ESPERO A QUE SE CARGUE EL RCREG, SI MANEJO INT OMITO ESTA PREGUNT A MENOS QU
                            E HAYA OTRA INTERRUPCION ENTONCES TENGO QUE HACER POLLIN PARA SABER CUAL FLAG SE LEVANTO
000C   2???           00033     GOTO RECIBIR;           POR SI CAMBIO EL MENSAJE DESDE QUE ENTRE AQUI, ESPERO A TENER EL MENSAJE MAS
                             NUEVO
000D   2???           00034     CALL REVISAR;           MENSAJE EN RCREG, CHEQUEO ERRORES EN LA TRANSMISION
000E   0818           00035     MOVF RCSTA, W;          LEO EL ESTATUS DE LOS ERRORES ANTES QUE SE BORREN
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
000F   00A1           00036     MOVWF SMS_ERR_STATUS;   LOS GUARDO EN UN REGISTRO TEMPORAL
0010   081A           00037     MOVF RCREG, W;          LEO EL MENSAJE RECIBIDO SIN ERRORES 
MPASM 5.86                      CISTERNA.ASM   8-6-2020  22:19:26         PAGE  2


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0011   00A0           00038     MOVWF SMS;              Y LO PASO A UN REGISTRO TEMPORAL
0012   2???           00039     CALL ON_OFF
0013   0008           00040     RETURN
0014                  00041 REVISAR:
0014   1918           00042     BTFSC RCSTA, FERR;      VERIFICO SI HUBO ERROR DE FERR, 
0015   2???           00043     GOTO ERR_1;             LEYO MAL EL BIT DE PARADA, LO LEYO COMO 0
0016   1898           00044     BTFSC RCSTA, OERR;      VERIFICO SI HUBO ERROR DE OERR
0017   2???           00045     GOTO ERR_2;             LEYO MAL UN BIT, NO CARGO COMPLETO 
0018   0008           00046     RETURN; SIN ERRORES PUEDO LEER
                      00047     
0019                  00048 ERR_1:
0019   0818           00049     MOVF RCSTA, W
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
001A   00A1           00050     MOVWF SMS_ERR_STATUS;   LEO LOS ERRORES Y LOS GUARDO
001B   081A           00051     MOVF RCREG, W;          LIMPIO EL BUFFER PARA LEER UN NUEVO MENSAJE LIMPIA RCREG, RCIF = 0, LIMPIA E
                            L FERR, LEE RX9D
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
001C   00A2           00052     MOVWF SMS_FERR;         MENSAJE MAS ABAJO
001D   2???           00053     GOTO RECIBIR;           RECIBE OTRA VEZ QUE VINO EL MENSAJE MALO
                      00054     ;/* GUARDO EL MENSAJE CON EL ERROR PARA COMPARAR
                      00055     ;/*O LLEVAR REGISTRO DE SI HUBO ERRORES EN LA RECEPCION ;PODRIA RETORNAR NORMAL, SI ACTIVO LA INTERR
                            UPCION PORQUE AL LEER EL RCREG, 
                      00056     ;/* ESTOY LIMPIANDO LA BANDERA Y VOLVERIA A ESPERAR QUE SE CARGUE EL MENSAJE PARA RETORNAR */
                      00057     
001E                  00058 ERR_2:
001E   0818           00059     MOVF RCSTA, W
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
001F   00A1           00060     MOVWF SMS_ERR_STATUS;   LEO LOS ERRORES Y LOS GUARDO
0020   081A           00061     MOVF RCREG, W;          LEO RX9D, LIMPIO EL RCREG Y EL FERR PARA RECIBIR UN NUEVO MENSAJE
                      00062     
                      00063 ; CREO QUE LEE EL MENSAJE ANTERIOR O LEE CERO, SI LO CARGA MAL LO QUE ESTA RSR SE BORRA
                      00064 ;PERO BLOQUEA LA RECEPCION!!! HAY QUE ESTAR PILA
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0021   00A3           00065     MOVWF SMS_OERR;         GUARDO EL MENSAJE MALO PARA COMPARAR CON LOS BUENOS
0022   1218           00066     BCF RCSTA,CREN;         LIMPIO EL ERROR
0023   1618           00067     BSF RCSTA,CREN;         LIMPIO EL ERROR
0024   2???           00068     GOTO RECIBIR;           VUELVE A RECIBIR QUE EL MENSAJE VINO MALO
                      00069 
0025                  00070 ON_OFF:
0025   3001           00071     MOVLW 0X01; 'ON'
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0026   0520           00072     ANDWF SMS, W
0027   1C00           00073     BTFSS W,0
0028   2???           00074     GOTO OFF
0029   2???           00075     CALL ON
002A   0008           00076     RETURN
                      00077     
002B                  00078 OFF:
002B   1197           00079                 BCF             CCP1CON,3               ; PWM MODE DISABLED
002C   1117           00080                 BCF             CCP1CON,2
002D   1097           00081                 BCF             CCP1CON,1
002E   1017           00082                 BCF             CCP1CON,0                                               
MPASM 5.86                      CISTERNA.ASM   8-6-2020  22:19:26         PAGE  3


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

002F   0008           00083                 RETURN
0030                  00084 ON:
                      00085                                                                 ;SE SUPONE QUE ACA SOLO VENGO POR ORDEN 
                            DEL TINACO PERO DEBEMOS CHEQUEAR EL NIVEL PRIMERO
0030   1103           00086                 BCF     STATUS,Z
0031   1003           00087                 BCF     STATUS,C;               NO SE SI ESTAS BANDERAS TAMBIEN HAY QUE LIMPIARLAS PERO 
                            PORSIA
0032   081E           00088                 MOVF    ADRESH,W;       NIVEL DEL TANQUE
0033   3C33           00089                 SUBLW   D'51';                  TESTEAR CON 1 VOLTIO
0034   1903           00090                 BTFSC   STATUS,Z
0035   2???           00091                 GOTO    OFF;    1 VOLTIO DE NIVEL
0036   1C03           00092                 BTFSS   STATUS,C
0037   2???           00093                 GOTO    PLAY;                   NIVEL > 1 VOLTIO
0038   2???           00094                 CALL    OFF;    NIVEL <1 VOLTIO
Warning[203]: Found opcode in column 1. (RETURN)
0039   0008           00095 RETURN;REVISAR QUE TE DEVUELVES AQUI Y QUE NO HAY REDUNDANCIA
                      00096 
003A                  00097 PLAY:
003A   1597           00098                 BSF             CCP1CON,3               ; PWM MODE ON
003B   1517           00099                 BSF             CCP1CON,2
003C   1497           00100                 BSF             CCP1CON,1
003D   1417           00101                 BSF             CCP1CON,0                       
Warning[203]: Found opcode in column 1. (RETURN)
003E   0008           00102 RETURN
                      00103     
                      00104     ;MANUAL:
                      00105     ;AQUI DEBERIA REVISAR EL NIVEL DEL AGUA EN EL TINACO, PERO TENGO QUE HACERLO AQUI MISMO
                      00106     ;SINO ME QUEDO EN LA INTERRUPCION PARA SIEMPRE, SERIA BUENO TENER LA INFO DEL NIVEL A LA MANO
                      00107     ;TIPO PARA NO SALIR DE ESTA RUTINA Y SOLO TRANSMITIR
                      00108     ; AQUI DEBERIA DESBLOQUEAR LA BOMBA PARA QUE LA PRENDAN AFUERA
                      00109     ;ESCENARIOS:
                      00110     ;SI ESTA LLENO EL TINACO TENGO QUE APAGAR PARA QUE NO SE BOTE EL AGUA
                      00111     ;VE
                      00112     
                      00113 ;PREGUNTO     
                      00114     
                      00115     ;SI NO HAY AGUA EN LA CISTERNA TENGO TRANSMITIR
                      00116 
                      00117     ;ACA VA LO DEMAS
                      00118     
                      00119     ; SI SE LLENO EL TINACO CUANDO VUELVA A ENTRAR AL CICLO CUMPLE LA CONDICION DE SALIDA Y 
                      00120     ;SALE PERO MIENTRAS ESTE EL SWITCHE ENCENDIDO, ESTO SE REPITE HASTA QUE PASEMOS EL SWITCHE
                      00121     ;CONDICION DE SALIDA AQUI ABAJO
                      00122     ;MOVLW 0X10; 'MANUAL'
                      00123     ;ANDWF SMS, W
                      00124     ;BTFSC W,4
                      00125     ;RETFIE; MANUAL ON, SALGO DE RUTINA SIN LIMPIAR LA BANDERA, PERO PRIMERO RECIBO EL MENSAJE PARA SALI
                            R
                      00126     ;BCF INTCON, INTF; LIMPIO LA BANDERA PARA SALIR DEL MODO MANUAL, OFF
                      00127     ;RETURN
                      00128 
003F                  00129 INICIO:                                         
                      00130 ;/*******************************************************************************
MPASM 5.86                      CISTERNA.ASM   8-6-2020  22:19:26         PAGE  4


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00131 ;**********************  CISTERNA Y PWM ***********************************************/
                      00132 ;   PR2 = 155
                      00133 ;   CCPR1L = 00111110
                      00134 ;   CCPCON1 = 10
                      00135 ;   CCP1CON -> SALIDA RC2
                      00136 ;   PRESCALER = 4
                      00137 ;   TMR2 ON
                      00138 ;   CCP1 = PWM OPERACION
                      00139 ;       PERIODO PWM 100MICROSEGUNDOS
003F   0185           00140                 CLRF PORTA
0040   0186           00141                 CLRF PORTB
0041   0187           00142                 CLRF PORTC
0042   0188           00143                 CLRF PORTD
0043   0189           00144                 CLRF PORTE; LIMPIO LOS PUERTOS
0044   1303           00145                 BCF STATUS,RP1;
0045   1683           00146                 BSF STATUS,RP0;         CAMBIO DE BANCO
                      00147                                                                 ;BANCO 1
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0046   1106           00148                 BCF TRISB, 2
                      00149 ;CISTERNA
0047   302F           00150                 MOVLW   d'47'                   ; 00101111B CONFIG PUERTO A CON 5 ENTRADAS Y UNA SALIDA(
                            RA4)
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0048   0085           00151                 MOVWF   TRISA                   ;RA0:RA3,RA5 -> ENTRADAS
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0049   1305           00152                 BCF TRISA,6
                      00153                                                                 ;CONFIGURACION DE LOS PINES DEL CONVERTI
                            DOR A/D, AFECTA 8 PINES
                      00154                                                                 ;RA0-RA5 Y RE0-RE2
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
004A   119F           00155                 BCF             ADCON1,PCFG3    ;PCFG3:PCFG0 (ADCON1<3:0>)      
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
004B   111F           00156                 BCF             ADCON1,PCFG2
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
004C   149F           00157                 BSF             ADCON1,PCFG1
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
004D   101F           00158                 BCF             ADCON1,PCFG0    ;0010 -> 5 INPUTS A Y 3 I/O DIGITALES
                      00159 ;       /*
                      00160             ;RA0 = AN0 -> INPUT NO INV COMPARADOR A 1
                      00161             ;RA1 = AN1 -> INPUT NO INV COMPARADOR A 2
                      00162             ;RA2 = AN2 -> SOBREESCRITO AL USAR EL COMPARADOR? I/O DIGITAL, NON-USED
                      00163             ;RA3 = AN3 -> INPUT INV COMPARADOR A 1 Y 2, REFERENCIA COMUN
                      00164             ;RA5 = AN4 -> INPUT CONVERTIDOR A/D -> CANAL
                      00165 ;*/
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
004E   171F           00166                 BSF             ADCON1,6;       SELECCION DEL BIT DE CONVERSION 2 DEL CLOCK: FOSC/64
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
004F   139F           00167                 BCF             ADCON1,7;       JUSTIFICADO A LA IZQ, ENMASCARA BITS <1:0 LOS PASOS DEBE
                            RIAN SER MULTIPLOS DE CUATRO PARA QUE LOS AGARRE???
                      00168 ;CONVERTIDOR ANALOGICO
0050   3002           00169                 MOVLW 0X02
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0051   009C           00170                 MOVWF CMCON
MPASM 5.86                      CISTERNA.ASM   8-6-2020  22:19:26         PAGE  5


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0052   161C           00171                 BSF CMCON, 4;   
                      00172 
                      00173 ;SERIAL
                      00174         
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0053   1307           00175                 BCF TRISC,6;        TX PIN COMO SALIDA
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0054   1787           00176                 BSF TRISC,7;        RX PIN COMO INPUT
0055   3081           00177                 MOVLW h'81';        X=129
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0056   0099           00178                 MOVWF SPBRG;        CONFIGURANDO EL BAUD RATE A 9600 BAUD/S CON EL CLOCK DE 20MHZ
0057   3026           00179                 MOVLW h'26';        TXEN=1, BRGH=1, TRMT=1, ESTE ES READ ONLY, PERO AJA, SIN PARIDAD
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0058   0098           00180                 MOVWF TXSTA;        CONFIGURANDO TXSTA COMO ASINCRONO
                      00181 
0059   30C0           00182                 MOVLW h'C0'
005A   008B           00183                 MOVWF INTCON; HABILITANDO GIE Y PEIE, esto tampoco hace nada
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
005B   168C           00184                 BSF PIE1,RCIE
005C   1303           00185                 BCF STATUS, RP1
005D   1283           00186                 BCF STATUS, RP0;    CAMBIO A BANCO 0
                      00187 
005E   3090           00188                 MOVLW h'90'
005F   0098           00189                 MOVWF RCSTA;        CONFIGURANDO EL RCSTA PARA ASINCRONO
0060   128C           00190                 BCF PIR1, RCIF;     LIMPIANDO LA BANDERA DE RECEPCION, no hace nada
                      00191                 
                      00192                 
                      00193                                                                 
0061   1283           00194                 BCF             STATUS,RP0
0062   1303           00195                 BCF             STATUS,RP1
                      00196 ;PWM
0063   309B           00197                 MOVLW   D'155'
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0064   0092           00198                 MOVWF   PR2
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0065   1107           00199                 BCF             TRISC,2         ;RC2
                      00200                                                                 ;BANCO 0
                      00201 ;CISTERNA
0066   179F           00202                 BSF             ADCON0,ADCS1;   CONVERSION DEL RELOJ
0067   131F           00203                 BCF             ADCON0,ADCS0;   FOSC/64
0068   169F           00204                 BSF             ADCON0,CHS2;    SELECCION DEL CANAL ANALOGICO
0069   121F           00205                 BCF             ADCON0,CHS1
006A   119F           00206                 BCF             ADCON0,CHS0;    CANAL AN4
006B   141F           00207                 BSF             ADCON0,0;       ADC ON
                      00208                 
                      00209 ;PWM
006C   303E           00210                 MOVLW   B'00111110' ;50%DUTYCYCLE
006D   0095           00211                 MOVWF   CCPR1L
006E   1697           00212                 BSF             CCP1CON,5       ; 1 
006F   1217           00213                 BCF             CCP1CON,4       ; 0
0070   1092           00214                 BCF             T2CON,1         ;4 PRESCALER
0071   1412           00215                 BSF             T2CON,0
MPASM 5.86                      CISTERNA.ASM   8-6-2020  22:19:26         PAGE  6


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0072   1512           00216                 BSF             T2CON,2         ; TMR2 ON
                      00217                 
                      00218 
0073                  00219 START:
Error[113]  : Symbol not previously defined (Retardo_400ms)
0073   2000           00220                 CALL Retardo_400ms
0074   151F           00221                 BSF             ADCON0,2                ;       GO/!DONE -> 1
Error[113]  : Symbol not previously defined (Retardo_400ms)
0075   2000           00222                 CALL Retardo_400ms
0076                  00223 ADC:
0076   191F           00224                 BTFSC   ADCON0,2
0077   2???           00225                 GOTO    ADC;                    MIENTRAS CONVERTIMOS
0078   1103           00226                 BCF             STATUS,Z
0079   1003           00227                 BCF             STATUS,C
007A   081E           00228                 MOVF    ADRESH,W;               NIVEL DEL TANQUE
007B   3C80           00229                 SUBLW   D'128';                 TESTEAR CON LA MIT
007C   1903           00230                 BTFSC   STATUS,Z
007D   2???           00231                 GOTO    MITAD;                  2.5 VOLTIOS DE NIVEL
007E   1C03           00232                 BTFSS   STATUS,C
007F   2???           00233                 GOTO    MLLENO;                 NIVEL > 2.5 VOLTIOS
0080   2???           00234                 GOTO    MVACIO;                 NIVEL < 2.5 VOLTIOS
                      00235 
                      00236 
0081                  00237 MITAD:                                                  
0081   2???           00238                 CALL    ABRIRVALVULA
                      00239                 ;BTFSS          ;C10OU                          ;TESTEAMOS EL ESTADO DE LA VALVULA
                      00240                 ;GOTO   MITAD
0082   2???           00241                 GOTO    START;                  
                      00242 
                      00243 
0083                  00244 MLLENO: 
0083   1103           00245                 BCF             STATUS,Z
0084   1003           00246                 BCF             STATUS,C;               NO SE SI ESTAS BANDERAS TAMBIEN HAY QUE LIMPIARL
                            AS PERO PORSIA, SI SI HAY QUE LIMPIARLAS CRACK!
0085   081E           00247                 MOVF    ADRESH,W;               NIVEL DEL TANQUE
0086   3CCD           00248                 SUBLW   D'205';                 TESTEAR CON 4 VOLTIOS
0087   1903           00249                 BTFSC   STATUS,Z
0088   2???           00250                 GOTO    CUATRO;                 4 VOLTIOS DE NIVEL
0089   1C03           00251                 BTFSS   STATUS,C        
008A   2???           00252                 GOTO    MAYOR4;                 NIVEL > 4 VOLTIOS
008B   2???           00253                 GOTO    NIVEL2;                 NIVEL < 4 VOLTIOS
                      00254 
                      00255                 
008C                  00256 CUATRO: 
008C   2???           00257                 CALL    ABRIRVALVULA    ;ACA SIEMPRE ESATAREMOS LLENANDO MIENTRAS HAYA AGUA A EXCEPCION 
                            DE QUE ESTEMOS FULLS
                      00258                                                                 ;NO COMO EN EL TINACO QUE SI HAY QUE RES
                            PETAR LA CONDICION DE LOS 4 VOLTIOS
                      00259                 ;BTFSS                                          ;TESTEAMOS ESTADO DE LA VALVULA
                      00260                 ;GOTO   CUATRO
008D   2???           00261                 GOTO    START; 
                      00262 
                      00263                 
MPASM 5.86                      CISTERNA.ASM   8-6-2020  22:19:26         PAGE  7


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

008E                  00264 MAYOR4:
008E   1103           00265                 BCF             STATUS,Z
008F   1003           00266                 BCF             STATUS,C;               NO SE SI ESTAS BANDERAS TAMBIEN HAY QUE LIMPIARL
                            AS PERO PORSIA
0090   081E           00267                 MOVF    ADRESH,W;               NIVEL DEL TANQUE
0091   3CFF           00268                 SUBLW   D'255';                 TESTEAR CON 5 VOLTIOS
0092   1903           00269                 BTFSC   STATUS,Z
0093   2???           00270                 GOTO    LLENO;                  5 VOLTIOS DE NIVEL
0094   1C03           00271                 BTFSS   STATUS,C
0095   2???           00272                 GOTO    AGUAAA;                 NIVEL > 5 VOLTIOS
0096   2???           00273                 GOTO    NIVEL3;                 NIVEL < 5 VOLTIOS
                      00274         
                      00275 
0097                  00276 LLENO:
0097   2???           00277         CALL    CERRARVALVULA   ;DE MADRUGADA Y SI ACASO PQ AJA
                      00278                                                                 ;CASO MUY RARO DE ESTAR FULLS DE AGUA EN
                             TODOS LADOS
                      00279                 ;BTFSC;                   ;COMPROBAMOS QUE ESTA CERRADA
                      00280        ; GOTO    LLENO
0098   2???           00281                 GOTO    START                           
                      00282 
                      00283 
0099                  00284 NIVEL3:
0099   2???           00285                 CALL    ABRIRVALVULA    ; NIVEL 3
                      00286                 ;BTFSS                                          ;TESTEAMOS ESTADO DE LA VALVULA
                      00287                 ;GOTO   NIVEL3
009A   2???           00288                 GOTO    START                                           
                      00289 
                      00290 
009B                  00291 AGUAAA:
009B   2???           00292                 CALL    CERRARVALVULA   ;DESPIERTA ESTO ES VENEZUELA
                      00293                 ;BTFSC                                  ;ESTE CASO SOLO LO ESTARIAMOS MANEJANDO PARA EL 
                            SUPUESTO ERROR DE
                      00294                 ;GOTO   AGUAAA                  ;TENER AGUA DE MAS Y SIMPLEMENTE CERRAMOS LA VALVULA COM
                            O EL LLENO
009C   2???           00295                 GOTO    START
                      00296 
                      00297 
009D                  00298 NIVEL2:
009D   2???           00299                 CALL    ABRIRVALVULA    ;NIVEL 2
                      00300                 ;BTFSS                                  ;TESTEAMOS ESTADO DE LA VALVULA
                      00301                 ;GOTO   NIVEL2                                  
009E   2???           00302                 GOTO    START   
                      00303 
                      00304 
009F                  00305 MVACIO: 
009F   1103           00306                 BCF             STATUS,Z
00A0   1003           00307                 BCF             STATUS,C;                NO SE SI ESTAS BANDERAS TAMBIEN HAY QUE LIMPIAR
                            LAS PERO PORSIA
00A1   081E           00308                 MOVF    ADRESH,W;       NIVEL DEL TANQUE
00A2   3C33           00309                 SUBLW   D'51';                  TESTEAR CON 1 VOLTIO
00A3   1903           00310                 BTFSC   STATUS,Z
00A4   2???           00311                 GOTO    BOMBAOFF;               1 VOLTIO DE NIVEL
MPASM 5.86                      CISTERNA.ASM   8-6-2020  22:19:26         PAGE  8


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00A5   1C03           00312                 BTFSS   STATUS,C
00A6   2???           00313                 GOTO    NIVEL1;                 NIVEL > 1 VOLTIO
00A7   2???           00314                 GOTO    SEQUEMO;        NIVEL <1 VOLTIO
                      00315 
                      00316 
00A8                  00317 BOMBAOFF:
00A8   2???           00318                 CALL    APAGARBOMBA
                      00319                 ;AND MENSAJE LEER Y COM[ARAR                                            ;NO VEO OTRA MAN
                            ERA DE HACER ESTO DISTINTA A DESHABILITAR EL MODULO
                      00320                                                                 ;Y POR ENDE NO TENGO NADA QUE TESTEAR PA
                            RA QUE SI HAYA ESTA APAGADA
                      00321                                                                 ;NO LA SIGA REAPAGANDO HASTA QUE EL NIVE
                            L DEL AGUA SUBA
00A9   2???           00322                 GOTO    START
                      00323 
00AA                  00324 NIVEL1:
00AA   2???           00325         CALL    ABRIRVALVULA    ;NIVEL 1
                      00326                 ;BTFSS                                  ;TESTEAMOS ESTADO DE LA VALVULA
                      00327                 ;GOTO   NIVEL1
00AB   2???           00328                 GOTO    START
                      00329 
                      00330 
00AC                  00331 SEQUEMO:
00AC   2???           00332                 CALL    APAGARBOMBA             ; MISMO CASO DE CUANDO HAY MAS DE 5V DE AGUA
                      00333                                                                 ; PREVENCION Y MISMA RESOLUCION POR POSI
                            BLES ERRORES
00AD   2???           00334                 GOTO    START
                      00335 
00AE                  00336 ABRIRVALVULA                                    ;-----------------ESTOY TOMANDO EN CUANTA QUE LA VALVULA
                             ABIERTA ES 1 Y CERRADA 0-----------------------
00AE   1303           00337                 BCF STATUS, RP1 
00AF   1683           00338                 BSF STATUS, RP0                                         ;-----------------IGUAL DE SER A
                            L REVES SIMPLEMENTE HAY QUE INVERTIR LOS BTFSC Y BTFSS------------------
                      00339                                                         ;-----------------IGUAL DE SER AL REVES SIMPLEME
                            NTE HAY QUE INVERTIR LOS BTFSC Y BTFSS------------------
                      00340                                                                 ;-----------------PERO PARA QUE ENTIENDA
                            S LA LOGICA IGUAL CON LA PRESION 1 HAY 0 NO HAY-----------------
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00B0   1F1C           00341                 BTFSS  CMCON, C1OUT;TESTEO LA PRESION DEL AGUA CON C1OUT O EL QUE TENGA QUE SER
00B1   2???           00342                 CALL    MANUAL
                      00343                 ;BTFSS  PORTB,RB2                               ; TESTEO EL ESTADO DE LA VALVULA
00B2   1506           00344                 BSF     PORTB, RB2                              ;ABRIMOS LA VALVULA
00B3   0008           00345                 RETURN
00B4                  00346 CERRARVALVULA
                      00347                                         ;TESTEAMOS ESTADO DE LA VALVULA
00B4   1106           00348                 BCF             PORTB, RB2                              ;CERRAMOS LA VALVULA
                      00349                                                                 ;SOLO CERRAREMOS LA VALVULA ESTANDO LLEN
                            OS
                      00350                                                                 ;O SI NOS LLAMA MANUAL  
00B5   0008           00351                 RETURN
00B6                  00352 APAGARBOMBA
00B6   1197           00353                 BCF             CCP1CON,3               ; PWM MODE DISABLED
00B7   1117           00354                 BCF             CCP1CON,2
MPASM 5.86                      CISTERNA.ASM   8-6-2020  22:19:26         PAGE  9


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00B8   1097           00355                 BCF             CCP1CON,1
00B9   1017           00356                 BCF             CCP1CON,0                                               
00BA   0008           00357                 RETURN
00BB                  00358 ENCENDEBOMBA
                      00359                                                                 ;SE SUPONE QUE ACA SOLO VENGO POR ORDEN 
                            DEL TINACO PERO DEBEMOS CHEQUEAR EL NIVEL PRIMERO
00BB   1103           00360                 BCF             STATUS,Z
00BC   1003           00361                 BCF             STATUS,C;               NO SE SI ESTAS BANDERAS TAMBIEN HAY QUE LIMPIARL
                            AS PERO PORSIA
00BD   081E           00362                 MOVF    ADRESH,W;       NIVEL DEL TANQUE
00BE   3C33           00363                 SUBLW   D'51';                  TESTEAR CON 1 VOLTIO
00BF   1903           00364                 BTFSC   STATUS,Z
00C0   2???           00365                 CALL    APAGARBOMBA;    1 VOLTIO DE NIVEL
00C1   1C03           00366                 BTFSS   STATUS,C
00C2   2???           00367                 GOTO    PLAY;                   NIVEL > 1 VOLTIO
00C3   2???           00368                 CALL    APAGARBOMBA;    NIVEL <1 VOLTIO
                      00369                 
                      00370                 ;ESTO NO ME GUSTA NADA PERO BERRO SIGO SIN SABER BIEN COMO SERA EL PROCESO SERIAL
                      00371                                                                 ;PQ SOLO ESTOY HACIENDO ESTO TIPO QUE AL
                             RECIBIR LA SENAL DE ENCENDERBOMBA
                      00372                                                                 ;VENGO ACA Y COMPRUEBO QUE EL NIVEL ES M
                            AYOR A 1 VOLTIO PARA ENCENDER Y SINO LA APAGO
                      00373                                                                 ;ASI YA ESTE APAGADA O LE DIGO AL TINACO
                             QUE NO LA PUEDO PRENDER PERO COMO NO SE SI ESO
                      00374                                                                 ;SE PUEDE Y ES LO QUE HARIAMOS SI EL NIV
                            EL ES MENOR O IGUAL A 1 VOLTIO LO PONGO ASI
                      00375                                                                 ;FEO PERO YA ACA EN EL CODIGO A FALTA DE
                             MODIFICARLO PUES, SE QUE NO ESTA BIEN PERO YA LO
                      00376                                                                 ;ACOMODAREMOS ACOPLANDO LA COMUNICACION
00C4                  00377 MANUAL  
00C4   2???           00378                 CALL    CERRARVALVULA   ;CAEMOS AQUI SE SUPONE QUE PQ NO HAY PRESION COMO YA SABEMOS
00C5   1303           00379                 BCF     STATUS, RP1     
00C6   1683           00380                 BSF     STATUS, RP0                                             
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00C7   1F1C           00381                 BTFSS   CMCON, C1OUT                            ;TESTEAMOS LA PRESION
00C8   2???           00382                 GOTO    MANUAL                  ;SEGUN MI LOGICA FUNCIONA AL PELO ESTA MANERA SOLO FALTA
                             INGENIARSE COMO
                      00383                                                                 ;HACER QUE SIGA CUMPLIENDO CON LOS REQUE
                            RIMIENTOS DEL TINACO PERO ESO
00C9   1303           00384                 BCF STATUS, RP1 
00CA   1283           00385                 BCF STATUS, RP0                                                 ;SEGURO LO RESOLVEMOS AL
                             ESTAR ACOPLANDO EL PWM Y LA RECEPCION SERIAL
00CB   0008           00386                 RETURN
                      00387 
Warning[205]: Found directive in column 1. (include)
Error[105]  : Cannot open file (Include File "RETARDO.inc" not found)
                      00388 include "RETARDO.inc"   
Warning[205]: Found directive in column 1. (END)
3F72                  00389 END
MPASM 5.86                      CISTERNA.ASM   8-6-2020  22:19:26         PAGE 10


SYMBOL TABLE
  LABEL                             VALUE 

ABRIRVALVULA                      000000AE
ACKDT                             00000005
ACKEN                             00000004
ACKSTAT                           00000006
ADC                               00000076
ADCON0                            0000001F
ADCON1                            0000009F
ADCS0                             00000006
ADCS1                             00000007
ADCS2                             00000006
ADDEN                             00000003
ADFM                              00000007
ADIE                              00000006
ADIF                              00000006
ADON                              00000000
ADRESH                            0000001E
ADRESL                            0000009E
AGUAAA                            0000009B
APAGARBOMBA                       000000B6
BCLIE                             00000003
BCLIF                             00000003
BF                                00000000
BOMBAOFF                          000000A8
BRGH                              00000002
C                                 00000000
C1INV                             00000004
C1OUT                             00000006
C2INV                             00000005
C2OUT                             00000007
CCP1CON                           00000017
CCP1IE                            00000002
CCP1IF                            00000002
CCP1M0                            00000000
CCP1M1                            00000001
CCP1M2                            00000002
CCP1M3                            00000003
CCP1X                             00000005
CCP1Y                             00000004
CCP2CON                           0000001D
CCP2IE                            00000000
CCP2IF                            00000000
CCP2M0                            00000000
CCP2M1                            00000001
CCP2M2                            00000002
CCP2M3                            00000003
CCP2X                             00000005
CCP2Y                             00000004
CCPR1                             00000015
CCPR1H                            00000016
CCPR1L                            00000015
CCPR2                             0000001B
CCPR2H                            0000001C
CCPR2L                            0000001B
MPASM 5.86                      CISTERNA.ASM   8-6-2020  22:19:26         PAGE 11


SYMBOL TABLE
  LABEL                             VALUE 

CERRARVALVULA                     000000B4
CHS0                              00000003
CHS1                              00000004
CHS2                              00000005
CIS                               00000003
CKE                               00000006
CKP                               00000004
CM0                               00000000
CM1                               00000001
CM2                               00000002
CMCON                             0000009C
CMIE                              00000006
CMIF                              00000006
CREN                              00000004
CSRC                              00000007
CUATRO                            0000008C
CVR0                              00000000
CVR1                              00000001
CVR2                              00000002
CVR3                              00000003
CVRCON                            0000009D
CVREN                             00000007
CVROE                             00000006
CVRR                              00000005
D                                 00000005
DATA_ADDRESS                      00000005
DC                                00000001
D_A                               00000005
D_NOT_A                           00000005
EEADR                             0000010D
EEADRH                            0000010F
EECON1                            0000018C
EECON2                            0000018D
EEDATA                            0000010C
EEDATH                            0000010E
EEIE                              00000004
EEIF                              00000004
EEPGD                             00000007
ENCENDEBOMBA                      000000BB
ERR_1                             00000019
ERR_2                             0000001E
F                                 00000001
FERR                              00000002
FSR                               00000004
GCEN                              00000007
GIE                               00000007
GO                                00000002
GO_DONE                           00000002
GO_NOT_DONE                       00000002
I2C_DATA                          00000005
I2C_READ                          00000002
I2C_START                         00000003
I2C_STOP                          00000004
MPASM 5.86                      CISTERNA.ASM   8-6-2020  22:19:26         PAGE 12


SYMBOL TABLE
  LABEL                             VALUE 

IBF                               00000007
IBOV                              00000005
INDF                              00000000
INICIO                            0000003F
INTCON                            0000000B
INTE                              00000004
INTEDG                            00000006
INTF                              00000001
IRP                               00000007
LLENO                             00000097
MANUAL                            000000C4
MAYOR4                            0000008E
MITAD                             00000081
MLLENO                            00000083
MVACIO                            0000009F
NIVEL1                            000000AA
NIVEL2                            0000009D
NIVEL3                            00000099
NIVEL_TINACO                      000000A4
NOT_A                             00000005
NOT_ADDRESS                       00000005
NOT_BO                            00000000
NOT_BOR                           00000000
NOT_DONE                          00000002
NOT_PD                            00000003
NOT_POR                           00000001
NOT_RBPU                          00000007
NOT_RC8                           00000006
NOT_T1SYNC                        00000002
NOT_TO                            00000004
NOT_TX8                           00000006
NOT_W                             00000002
NOT_WRITE                         00000002
OBF                               00000006
OERR                              00000001
OFF                               0000002B
ON                                00000030
ON_OFF                            00000025
OPTION_REG                        00000081
P                                 00000004
PCFG0                             00000000
PCFG1                             00000001
PCFG2                             00000002
PCFG3                             00000003
PCL                               00000002
PCLATH                            0000000A
PCON                              0000008E
PEIE                              00000006
PEN                               00000002
PIE1                              0000008C
PIE2                              0000008D
PIR1                              0000000C
PIR2                              0000000D
MPASM 5.86                      CISTERNA.ASM   8-6-2020  22:19:26         PAGE 13


SYMBOL TABLE
  LABEL                             VALUE 

PLAY                              0000003A
PORTA                             00000005
PORTB                             00000006
PORTC                             00000007
PORTD                             00000008
PORTE                             00000009
PR2                               00000092
PS0                               00000000
PS1                               00000001
PS2                               00000002
PSA                               00000003
PSPIE                             00000007
PSPIF                             00000007
PSPMODE                           00000004
R                                 00000002
RA0                               00000000
RA1                               00000001
RA2                               00000002
RA3                               00000003
RA4                               00000004
RA5                               00000005
RB0                               00000000
RB1                               00000001
RB2                               00000002
RB3                               00000003
RB4                               00000004
RB5                               00000005
RB6                               00000006
RB7                               00000007
RBIE                              00000003
RBIF                              00000000
RC0                               00000000
RC1                               00000001
RC2                               00000002
RC3                               00000003
RC4                               00000004
RC5                               00000005
RC6                               00000006
RC7                               00000007
RC8_9                             00000006
RC9                               00000006
RCD8                              00000000
RCEN                              00000003
RCIE                              00000005
RCIF                              00000005
RCREG                             0000001A
RCSTA                             00000018
RD                                00000000
RD0                               00000000
RD1                               00000001
RD2                               00000002
RD3                               00000003
RD4                               00000004
MPASM 5.86                      CISTERNA.ASM   8-6-2020  22:19:26         PAGE 14


SYMBOL TABLE
  LABEL                             VALUE 

RD5                               00000005
RD6                               00000006
RD7                               00000007
RE0                               00000000
RE1                               00000001
RE2                               00000002
READ_WRITE                        00000002
RECIBIR                           00000009
REVISAR                           00000014
RP0                               00000005
RP1                               00000006
RSEN                              00000001
RX9                               00000006
RX9D                              00000000
R_NOT_W                           00000002
R_W                               00000002
S                                 00000003
SEN                               00000000
SEQUEMO                           000000AC
SMP                               00000007
SMS                               000000A0
SMS_ERR_STATUS                    000000A1
SMS_FERR                          000000A2
SMS_OERR                          000000A3
SPBRG                             00000099
SPEN                              00000007
SREN                              00000005
SSPADD                            00000093
SSPBUF                            00000013
SSPCON                            00000014
SSPCON2                           00000091
SSPEN                             00000005
SSPIE                             00000003
SSPIF                             00000003
SSPM0                             00000000
SSPM1                             00000001
SSPM2                             00000002
SSPM3                             00000003
SSPOV                             00000006
SSPSTAT                           00000094
START                             00000073
STATUS                            00000003
SYNC                              00000004
T0CS                              00000005
T0IE                              00000005
T0IF                              00000002
T0SE                              00000004
T1CKPS0                           00000004
T1CKPS1                           00000005
T1CON                             00000010
T1INSYNC                          00000002
T1OSCEN                           00000003
T1SYNC                            00000002
MPASM 5.86                      CISTERNA.ASM   8-6-2020  22:19:26         PAGE 15


SYMBOL TABLE
  LABEL                             VALUE 

T2CKPS0                           00000000
T2CKPS1                           00000001
T2CON                             00000012
TMR0                              00000001
TMR0IE                            00000005
TMR0IF                            00000002
TMR1                              0000000E
TMR1CS                            00000001
TMR1H                             0000000F
TMR1IE                            00000000
TMR1IF                            00000000
TMR1L                             0000000E
TMR1ON                            00000000
TMR2                              00000011
TMR2IE                            00000001
TMR2IF                            00000001
TMR2ON                            00000002
TOUTPS0                           00000003
TOUTPS1                           00000004
TOUTPS2                           00000005
TOUTPS3                           00000006
TRISA                             00000085
TRISA0                            00000000
TRISA1                            00000001
TRISA2                            00000002
TRISA3                            00000003
TRISA4                            00000004
TRISA5                            00000005
TRISB                             00000086
TRISB0                            00000000
TRISB1                            00000001
TRISB2                            00000002
TRISB3                            00000003
TRISB4                            00000004
TRISB5                            00000005
TRISB6                            00000006
TRISB7                            00000007
TRISC                             00000087
TRISC0                            00000000
TRISC1                            00000001
TRISC2                            00000002
TRISC3                            00000003
TRISC4                            00000004
TRISC5                            00000005
TRISC6                            00000006
TRISC7                            00000007
TRISD                             00000088
TRISD0                            00000000
TRISD1                            00000001
TRISD2                            00000002
TRISD3                            00000003
TRISD4                            00000004
TRISD5                            00000005
MPASM 5.86                      CISTERNA.ASM   8-6-2020  22:19:26         PAGE 16


SYMBOL TABLE
  LABEL                             VALUE 

TRISD6                            00000006
TRISD7                            00000007
TRISE                             00000089
TRISE0                            00000000
TRISE1                            00000001
TRISE2                            00000002
TRMT                              00000001
TX8_9                             00000006
TX9                               00000006
TX9D                              00000000
TXD8                              00000000
TXEN                              00000005
TXIE                              00000004
TXIF                              00000004
TXREG                             00000019
TXSTA                             00000098
UA                                00000001
W                                 00000000
WCOL                              00000007
WR                                00000001
WREN                              00000002
WRERR                             00000003
Z                                 00000002
_BODEN_OFF                        00003FBF
_BODEN_ON                         00003FFF
_BOREN_OFF                        00003FBF
_BOREN_ON                         00003FFF
_CONFIG                           00002007
_CPD_OFF                          00003FFF
_CPD_ON                           00003EFF
_CP_ALL                           00001FFF
_CP_OFF                           00003FFF
_CP_ON                            00001FFF
_DEBUG_OFF                        00003FFF
_DEBUG_ON                         000037FF
_DEVID1                           00002006
_FOSC_EXTRC                       00003FFF
_FOSC_HS                          00003FFE
_FOSC_LP                          00003FFC
_FOSC_XT                          00003FFD
_HS_OSC                           00003FFE
_IDLOC0                           00002000
_IDLOC1                           00002001
_IDLOC2                           00002002
_IDLOC3                           00002003
_LP_OSC                           00003FFC
_LVP_OFF                          00003F7F
_LVP_ON                           00003FFF
_PWRTE_OFF                        00003FFF
_PWRTE_ON                         00003FF7
_RC_OSC                           00003FFF
_WDTE_OFF                         00003FFB
_WDTE_ON                          00003FFF
MPASM 5.86                      CISTERNA.ASM   8-6-2020  22:19:26         PAGE 17


SYMBOL TABLE
  LABEL                             VALUE 

_WDT_OFF                          00003FFB
_WDT_ON                           00003FFF
_WRT_1FOURTH                      00003BFF
_WRT_256                          00003DFF
_WRT_HALF                         000039FF
_WRT_OFF                          00003FFF
_XT_OSC                           00003FFD
__16F877A                         00000001

Errors   :     3
Warnings :     6 reported,     0 suppressed
Messages :    28 reported,     0 suppressed

