
; PIC16F877A Configuration Bit Settings

; Assembly source line config statements

#include "p16f877a.inc"

; CONFIG
; __config 0xFF32
 __CONFIG _FOSC_HS & _WDTE_OFF & _PWRTE_ON & _BOREN_OFF & _LVP_OFF & _CPD_OFF & _WRT_OFF & _CP_OFF

 CBLOCK
 CUENTA
 AUMENTO
 ENDC
 
 NUMERO EQU .10
 
 ;   TMR1 => 0 A 65535
;
;   TMR1 = 65535 - ((TIEMPO_DESEADO*FOSC)/(PRESCALER*4)) - 1  
;   (100mS) TMR1 = 65535 - ((100ms*20MHZ)/(8*4)) -1
;   (100mS) TMR1 = 65535 - 62500 -1 = 3036
;   TMR1 = 3036 => 0x0BDC
;    
 
	ORG	0
	GOTO	INICIO
	ORG	4
	GOTO	INT_TMR1
	
INICIO
	BSF	STATUS,RP0
	BCF	STATUS,RP1
	CLRF	TRISD
	BSF	PIE1,0 ;TMR1 ENABLE
	BCF	STATUS,RP0
	BCF	T1CON,1 ;TEMPORIZADOR
	BSF	T1CON,5
	BSF	T1CON,4 ;PRESCALER 8	
	BSF	INTCON,7; GIE
	BSF	INTCON,6; PIEI
	BCF	PIR1,0; FLANCO TIMER1
	BSF	T1CON,0; TMR1 ON
	MOVLW	.0
	MOVWF	AUMENTO
	;0BDC
	MOVLW	0X0B
	MOVWF	TMR1H
	MOVLW	0XDC
	MOVWF	TMR1L
	MOVLW	.0
	MOVWF	PORTD
START
	MOVF	AUMENTO,W
	MOVWF	PORTD
	GOTO	START
	
INT_TMR1
	MOVLW	0X0B
	MOVWF	TMR1H
	MOVLW	0XDC
	MOVWF	TMR1L
	INCF	CUENTA,F
	MOVLW	NUMERO
	SUBWF	CUENTA,W; CUENTA - NUMERO = W
	BTFSC	STATUS,Z
	GOTO	IGUAL
	BTFSS	STATUS,C
	GOTO	MENOR
	GOTO	MAYOR
MENOR
	NOP	
	GOTO	FIN_INT
MAYOR
	NOP
	GOTO	FIN_INT
IGUAL
	INCF	AUMENTO,F
	MOVLW	.0
	MOVWF	CUENTA
FIN_INT
	BCF	PIR1,0
	RETFIE

	END
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	